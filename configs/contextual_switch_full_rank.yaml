name: contextual_switch_full_rank
description: Full network training for contextual switch task (train entire J matrix)

rnn:
  N: 500
  R: 2
  g: 0.8
  tau: 1.0
  phi: tanh
  d_in: 4
  use_bias: false
  M_init_std: 1.0
  N_init_std: 1.0
  B_init_std: 1.0
  w_init_std: 1.0
  J_init_std: 1.0

integrator:
  dt: 0.1
  T: 100.0
  solver_name: tsit5
  save_every: 1
  rtol: 0.001
  atol: 1.0e-06

training:
  batch_size: 32
  n_epochs: 100
  learning_rate: 0.001
  weight_decay: 0.0
  seed: 42
  log_every: 10
  eval_every: 100
  n_train_trials: 10000
  n_val_trials: 500
  optimizer: adam
  grad_clip: 1.0
  # Full rank training mode - trains entire J matrix directly
  training_mode: full_rank
  # Note: train_M and train_N are ignored in full_rank mode
  train_M: true
  train_N: true
  train_B: true
  train_w: true
  save_every: 1000
  checkpoint_dir: checkpoints

task:
  stim_std: 0.0
  stim_mean_abs: 1.2
  gamma_on: 0.08
  gamma_off: -0.14
  T_burn: 15.0
  T_stim: 85.0
  T_avg: 10.0
  label_type: pm1
  loss_type: mse
